# LG CNS Finance Tool - Spring Boot ë§ˆì´ê·¸ë ˆì´ì…˜ í”„ë¡œì íŠ¸ ê°œë°œ ê°€ì´ë“œ

> **ğŸ“‹ í”„ë¡œì íŠ¸ í•„ìˆ˜ ì°¸ê³  ë¬¸ì„œ**
> 
> ì´ ë¬¸ì„œëŠ” **í”„ë¡œì íŠ¸ ì „ì²´ ê°œë°œ ë°©í–¥ ë° ê°€ì´ë“œ**ë¥¼ ì œê³µí•©ë‹ˆë‹¤.
> - ìƒˆë¡œìš´ ê°œë°œ ì„¸ì…˜ ì‹œì‘ ì‹œ ë°˜ë“œì‹œ ì´ ë¬¸ì„œë¥¼ ë¨¼ì € ì½ìœ¼ì„¸ìš”
> - ëª¨ë“  ê°œë°œì€ ì´ ë¬¸ì„œì˜ ìš°ì„ ìˆœìœ„ì™€ ì„¤ê³„ë¥¼ ë”°ë¼ì•¼ í•©ë‹ˆë‹¤
> - ì„ì˜ë¡œ ë°ì´í„° êµ¬ì¡°ë‚˜ í”„ë¡œì„¸ìŠ¤ë¥¼ ë³€ê²½í•˜ì§€ ë§ˆì„¸ìš”
> 
> **GitHub ì €ì¥ì†Œ:**
> - ê¸°ì¡´ C# í”„ë¡œì íŠ¸: https://github.com/scschwan/lgcns_1st_nosql.git
> - ì‹ ê·œ Spring Boot í”„ë¡œì íŠ¸: https://github.com/scschwan/lg_cns_web.git

**ë¬¸ì„œ ë²„ì „:** 1.0  
**ìµœì¢… ì—…ë°ì´íŠ¸:** 2025-12-16  
**í”„ë¡œì íŠ¸ ëª©í‘œ:** C# WinForms FinanceToolì„ Spring Boot + React ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ìœ¼ë¡œ ë§ˆì´ê·¸ë ˆì´ì…˜

---

## ğŸ“‹ ëª©ì°¨
- [1. í”„ë¡œì íŠ¸ ê°œìš”](#1-í”„ë¡œì íŠ¸-ê°œìš”)
- [2. ê°œë°œ ìš°ì„ ìˆœìœ„ ë° ë‹¨ê³„](#2-ê°œë°œ-ìš°ì„ ìˆœìœ„-ë°-ë‹¨ê³„)
- [3. Phase 0: ì¸ì¦ ë° í”„ë¡œì íŠ¸ ê´€ë¦¬](#3-phase-0-ì¸ì¦-ë°-í”„ë¡œì íŠ¸-ê´€ë¦¬)
- [4. Phase 1: ëŒ€ìš©ëŸ‰ íŒŒì¼ ì—…ë¡œë“œ](#4-phase-1-ëŒ€ìš©ëŸ‰-íŒŒì¼-ì—…ë¡œë“œ)
- [5. Phase 2: ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ êµ¬í˜„](#5-phase-2-ë¹„ì¦ˆë‹ˆìŠ¤-ë¡œì§-êµ¬í˜„)
- [6. ë°ì´í„°ë² ì´ìŠ¤ ì„¤ê³„](#6-ë°ì´í„°ë² ì´ìŠ¤-ì„¤ê³„)
- [7. ê°œë°œ ìŠ¤ì¼€ì¤„](#7-ê°œë°œ-ìŠ¤ì¼€ì¤„)
- [8. ë‹¨ìœ„ ê°œë°œ ì²´í¬ë¦¬ìŠ¤íŠ¸](#8-ë‹¨ìœ„-ê°œë°œ-ì²´í¬ë¦¬ìŠ¤íŠ¸)

---

## 1. í”„ë¡œì íŠ¸ ê°œìš”

### 1.1 í”„ë¡œì íŠ¸ ëª©í‘œ

**ê¸°ì¡´ ì‹œìŠ¤í…œ:**
- C# WinForms ê¸°ë°˜ ë°ìŠ¤í¬í†± ì• í”Œë¦¬ì¼€ì´ì…˜
- ë¡œì»¬ Excel íŒŒì¼ ì²˜ë¦¬
- ë‹¨ì¼ ì‚¬ìš©ì í™˜ê²½
- MongoDB ì—°ë™

**ëª©í‘œ ì‹œìŠ¤í…œ:**
- Spring Boot + React ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜
- AWS í´ë¼ìš°ë“œ ê¸°ë°˜ (ECS Fargate, DocumentDB, S3, Lambda)
- ë‹¤ì¤‘ ì‚¬ìš©ì í˜‘ì—… ì§€ì›
- í”„ë¡œì íŠ¸ ë‹¨ìœ„ ë°ì´í„° ê´€ë¦¬
- ëŒ€ìš©ëŸ‰ íŒŒì¼ ë³‘ë ¬ ì²˜ë¦¬ (SQS + Lambda)

### 1.2 í•µì‹¬ ë§ˆì´ê·¸ë ˆì´ì…˜ ì›ì¹™

```
âœ… DO (ë°˜ë“œì‹œ ì§€ì¼œì•¼ í•  ì›ì¹™):
1. ê¸°ì¡´ C# ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ 100% ì¬í˜„
2. MongoDB ì»¬ë ‰ì…˜ êµ¬ì¡° ê·¸ëŒ€ë¡œ ìœ ì§€
3. 7ë‹¨ê³„ í”„ë¡œì„¸ìŠ¤ ìˆœì„œ ë° ë™ì‘ ë™ì¼í•˜ê²Œ êµ¬í˜„
4. í•„ë“œëª… ê·¸ëŒ€ë¡œ ì‚¬ìš© (data ë‚´ë¶€ í‚¤ë„ sanitization ë¶ˆí•„ìš”)
5. UI êµ¬ì„±ì€ C# WinFormsë¥¼ ë°˜ì‘í˜• ì›¹ìœ¼ë¡œ ì¬í•´ì„

âŒ DON'T (í•˜ì§€ ë§ì•„ì•¼ í•  ê²ƒ):
1. ì„ì˜ë¡œ ë°ì´í„° êµ¬ì¡° ë³€ê²½
2. ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ìˆœì„œ ë³€ê²½
3. ì»¬ë ‰ì…˜ ê´€ê³„ ì¬ì„¤ê³„
4. í•„ë“œëª… ë³€í™˜ (sanitization)
5. ê¸°ì¡´ ê¸°ëŠ¥ ìƒëµ
```

### 1.3 ì£¼ìš” ê°œì„ ì‚¬í•­

| í•­ëª© | ê¸°ì¡´ (C#) | ê°œì„  (Spring Boot) |
|------|-----------|-------------------|
| ë°°í¬ | ë¡œì»¬ ì„¤ì¹˜ | AWS í´ë¼ìš°ë“œ |
| ì‚¬ìš©ì | ë‹¨ì¼ ì‚¬ìš©ì | ë‹¤ì¤‘ ì‚¬ìš©ì + í˜‘ì—… |
| ì¸ì¦ | ì—†ìŒ | JWT ê¸°ë°˜ ì¸ì¦ |
| í”„ë¡œì íŠ¸ ê´€ë¦¬ | íŒŒì¼ ë‹¨ìœ„ | í”„ë¡œì íŠ¸ ë‹¨ìœ„ + ê³µìœ  |
| íŒŒì¼ ì²˜ë¦¬ | ë¡œì»¬ ì²˜ë¦¬ | SQS + Lambda ë³‘ë ¬ ì²˜ë¦¬ |
| UI | WinForms | React ë°˜ì‘í˜• ì›¹ |
| ë°ì´í„° ê³µìœ  | ë¶ˆê°€ | í”„ë¡œì íŠ¸ ë‹¨ìœ„ í˜‘ì—… |

---

## 2. ê°œë°œ ìš°ì„ ìˆœìœ„ ë° ë‹¨ê³„

### 2.1 ì „ì²´ ê°œë°œ ë¡œë“œë§µ

```
Phase 0: ì¸ì¦ ë° í”„ë¡œì íŠ¸ ê´€ë¦¬ (ìµœìš°ì„ )
   â”œâ”€ ì‚¬ìš©ì ë¡œê·¸ì¸/íšŒì›ê°€ì…
   â”œâ”€ JWT ì¸ì¦
   â”œâ”€ í”„ë¡œì íŠ¸ ìƒì„±/ê´€ë¦¬
   â”œâ”€ í”„ë¡œì íŠ¸ ê³µìœ  ë° ê¶Œí•œ ê´€ë¦¬
   â””â”€ í”„ë¡œì íŠ¸ë³„ ì„¸ì…˜ ê²©ë¦¬

Phase 1: ëŒ€ìš©ëŸ‰ íŒŒì¼ ì—…ë¡œë“œ (ìš°ì„ )
   â”œâ”€ S3 Presigned URL ì—…ë¡œë“œ
   â”œâ”€ SQS ë©”ì‹œì§€ í
   â”œâ”€ Lambda Coordinator (íŒŒì¼ ë¶„ì„)
   â”œâ”€ Lambda Worker (ë³‘ë ¬ íŒŒì‹±)
   â””â”€ ì§„í–‰ë¥  ì¶”ì  (Redis)

Phase 2: ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ êµ¬í˜„ (ìˆœì°¨)
   â”œâ”€ Step 1: Multi File Upload
   â”œâ”€ Step 2: File Load
   â”œâ”€ Step 3: Preprocessing
   â”œâ”€ Step 4: Data Transform
   â”œâ”€ Step 5: Classification
   â”œâ”€ Step 6: Clustering
   â””â”€ Step 7: Detail Clustering

Phase 3: UI êµ¬í˜„
   â”œâ”€ React í”„ë¡œì íŠ¸ êµ¬ì¡°
   â”œâ”€ C# WinForms UI ì¬í•´ì„
   â”œâ”€ ë°˜ì‘í˜• í…œí”Œë¦¿ ì ìš©
   â””â”€ 7ë‹¨ê³„ í”„ë¡œì„¸ìŠ¤ í™”ë©´
```

### 2.2 ì™œ ì´ ìˆœì„œì¸ê°€?

#### 2.2.1 Phase 0ê°€ ìµœìš°ì„ ì¸ ì´ìœ 

```
1. ëª¨ë“  ë°ì´í„°ëŠ” í”„ë¡œì íŠ¸ ë‹¨ìœ„ë¡œ ê´€ë¦¬ë¨
   â†’ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ì‹¤í–‰ ì „ í”„ë¡œì íŠ¸ ì»¨í…ìŠ¤íŠ¸ í•„ìš”

2. í˜‘ì—… ê¸°ëŠ¥ í•µì‹¬
   â†’ ì—¬ëŸ¬ ì‚¬ìš©ìê°€ ë™ì¼ í”„ë¡œì íŠ¸ì˜ ë°ì´í„°ë¥¼ ê³µìœ 

3. ë°ì´í„° ê²©ë¦¬
   â†’ í”„ë¡œì íŠ¸ Aì˜ ë°ì´í„°ì™€ í”„ë¡œì íŠ¸ Bì˜ ë°ì´í„° ë¶„ë¦¬

4. ê¶Œí•œ ê´€ë¦¬
   â†’ Owner, Editor, Viewer ì—­í•  ê¸°ë°˜ ì ‘ê·¼ ì œì–´
```

#### 2.2.2 Phase 1ì´ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ë³´ë‹¤ ìš°ì„ ì¸ ì´ìœ 

```
1. ëŒ€ìš©ëŸ‰ íŒŒì¼ ì²˜ë¦¬ëŠ” ë…ë¦½ì  ì¸í”„ë¼
   â†’ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ê³¼ ë¶„ë¦¬í•˜ì—¬ ë¨¼ì € ê²€ì¦ ê°€ëŠ¥

2. SQS + Lambda ë³‘ë ¬ ì²˜ë¦¬ëŠ” í•µì‹¬ ì°¨ë³„í™” ê¸°ëŠ¥
   â†’ 50-100MB íŒŒì¼ì„ ë¹ ë¥´ê²Œ ì²˜ë¦¬ (ê¸°ì¡´ C#ë³´ë‹¤ 10ë°° ì´ìƒ ë¹ ë¦„)

3. ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ ê°€ëŠ¥
   â†’ 100MB Excel íŒŒì¼ë¡œ ë³‘ë ¬ ì²˜ë¦¬ ì„±ëŠ¥ ê²€ì¦

4. ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ê°œë°œ ì‹œ íŒŒì¼ ì—…ë¡œë“œ ì¸í”„ë¼ ì¬ì‚¬ìš©
   â†’ Step 2 (File Load) ì‹œ ê²€ì¦ëœ ì—…ë¡œë“œ ë©”ì»¤ë‹ˆì¦˜ í™œìš©
```

---

## 3. Phase 0: ì¸ì¦ ë° í”„ë¡œì íŠ¸ ê´€ë¦¬

### 3.1 ëª©í‘œ

```
âœ… ì‚¬ìš©ì ë¡œê·¸ì¸/íšŒì›ê°€ì…
âœ… JWT ê¸°ë°˜ ì¸ì¦
âœ… í”„ë¡œì íŠ¸ ìƒì„±/ìˆ˜ì •/ì‚­ì œ
âœ… í”„ë¡œì íŠ¸ ë©¤ë²„ ì´ˆëŒ€ ë° ê¶Œí•œ ê´€ë¦¬
âœ… í”„ë¡œì íŠ¸ë³„ ë°ì´í„° ê²©ë¦¬
```

### 3.2 ë°ì´í„°ë² ì´ìŠ¤ í…Œì´ë¸” ì„¤ê³„

#### 3.2.1 users (ì‚¬ìš©ì ì •ë³´)

```javascript
{
    "_id": ObjectId("..."),
    "email": "user@example.com",        // ì´ë©”ì¼ (ë¡œê·¸ì¸ ID)
    "password": "$2a$10$...",             // BCrypt ì•”í˜¸í™”
    "name": "í™ê¸¸ë™",
    "created_at": ISODate("2025-12-16T00:00:00Z"),
    "last_login_at": ISODate("2025-12-16T10:00:00Z"),
    "is_active": true                     // ê³„ì • í™œì„±í™” ì—¬ë¶€
}
```

**Index:**
```javascript
db.users.createIndex({ "email": 1 }, { unique: true })
```

#### 3.2.2 projects (í”„ë¡œì íŠ¸ ì •ë³´)

```javascript
{
    "_id": ObjectId("..."),
    "project_id": "proj-uuid-123",        // UUID
    "name": "2025ë…„ ì¬ë¬´ ë¶„ì„",
    "description": "1ë¶„ê¸° ì¬ë¬´ ë°ì´í„° í´ëŸ¬ìŠ¤í„°ë§ í”„ë¡œì íŠ¸",
    "owner_id": ObjectId("..."),          // users ì°¸ì¡°
    "created_at": ISODate("2025-12-16T00:00:00Z"),
    "updated_at": ISODate("2025-12-16T10:00:00Z"),
    "is_active": true,
    "settings": {
        "max_file_size_mb": 500,
        "auto_clustering": true
    }
}
```

**Index:**
```javascript
db.projects.createIndex({ "project_id": 1 }, { unique: true })
db.projects.createIndex({ "owner_id": 1 })
```

#### 3.2.3 project_members (í”„ë¡œì íŠ¸ ë©¤ë²„ ë° ê¶Œí•œ)

```javascript
{
    "_id": ObjectId("..."),
    "project_id": "proj-uuid-123",        // projects ì°¸ì¡°
    "user_id": ObjectId("..."),           // users ì°¸ì¡°
    "role": "OWNER",                       // OWNER, EDITOR, VIEWER
    "invited_by": ObjectId("..."),         // ì´ˆëŒ€ì
    "joined_at": ISODate("2025-12-16T10:00:00Z"),
    "permissions": {
        "can_upload": true,
        "can_edit": true,
        "can_delete": false,
        "can_share": true
    }
}
```

**Index:**
```javascript
db.project_members.createIndex({ "project_id": 1, "user_id": 1 }, { unique: true })
db.project_members.createIndex({ "user_id": 1 })
```

**ì—­í• ë³„ ê¶Œí•œ:**

| ì—­í•  | ì¡°íšŒ | ì—…ë¡œë“œ | í¸ì§‘ | ì‚­ì œ | ë©¤ë²„ ì´ˆëŒ€ |
|------|------|--------|------|------|-----------|
| OWNER | âœ… | âœ… | âœ… | âœ… | âœ… |
| EDITOR | âœ… | âœ… | âœ… | âŒ | âŒ |
| VIEWER | âœ… | âŒ | âŒ | âŒ | âŒ |

#### 3.2.4 file_sessions (ìˆ˜ì • - í”„ë¡œì íŠ¸ ì—°ë™)

```javascript
{
    "_id": ObjectId("..."),
    "session_id": "session-uuid-456",
    "project_id": "proj-uuid-123",        // â­ ì¶”ê°€: projects ì°¸ì¡°
    "created_by": ObjectId("..."),        // â­ ì¶”ê°€: users ì°¸ì¡°
    "uploaded_files": [
        {
            "file_id": ObjectId("..."),
            "file_name": "ì¬ë¬´ë°ì´í„°_2025.xlsx",
            "file_size": 52428800,
            "uploaded_at": ISODate("2025-12-16T10:00:00Z")
        }
    ],
    "created_at": ISODate("2025-12-16T10:00:00Z"),
    "last_accessed_at": ISODate("2025-12-16T11:00:00Z")
}
```

#### 3.2.5 raw_data / process_data (ìˆ˜ì • - í”„ë¡œì íŠ¸ ì—°ë™)

```javascript
// raw_data
{
    "_id": ObjectId("..."),
    "project_id": "proj-uuid-123",        // â­ ì¶”ê°€: í”„ë¡œì íŠ¸ ê²©ë¦¬
    "session_id": "session-uuid-456",
    "data": {
        "Val.in RC": 1500000,
        "Date": "2025-01-01"
    },
    "import_date": ISODate("..."),
    "file_name": "ì¬ë¬´ë°ì´í„°_2025.xlsx",
    "is_hidden": false,
    "hidden_reason": null
}

// process_data
{
    "_id": ObjectId("..."),
    "project_id": "proj-uuid-123",        // â­ ì¶”ê°€: í”„ë¡œì íŠ¸ ê²©ë¦¬
    "raw_data_id": ObjectId("..."),
    "data": { ... },
    "cluster_id": 3,
    "cluster_name": "ê³ ì•¡ ê±°ë˜"
}
```

**Index:**
```javascript
db.raw_data.createIndex({ "project_id": 1, "session_id": 1 })
db.process_data.createIndex({ "project_id": 1 })
db.clustering_results.createIndex({ "project_id": 1 })
```

### 3.3 API ì„¤ê³„

#### 3.3.1 ì¸ì¦ API

```http
POST /api/auth/register
Body:
{
    "email": "user@example.com",
    "password": "password123",
    "name": "í™ê¸¸ë™"
}

Response:
{
    "userId": "user-id-123",
    "email": "user@example.com",
    "name": "í™ê¸¸ë™"
}

---

POST /api/auth/login
Body:
{
    "email": "user@example.com",
    "password": "password123"
}

Response:
{
    "accessToken": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
    "refreshToken": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
    "userId": "user-id-123",
    "email": "user@example.com",
    "name": "í™ê¸¸ë™"
}

---

POST /api/auth/refresh
Headers: Authorization: Bearer {refreshToken}

Response:
{
    "accessToken": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
}

---

POST /api/auth/logout
Headers: Authorization: Bearer {accessToken}

Response: 200 OK
```

#### 3.3.2 í”„ë¡œì íŠ¸ ê´€ë¦¬ API

```http
POST /api/projects
Headers: Authorization: Bearer {accessToken}
Body:
{
    "name": "2025ë…„ ì¬ë¬´ ë¶„ì„",
    "description": "1ë¶„ê¸° ì¬ë¬´ ë°ì´í„° í´ëŸ¬ìŠ¤í„°ë§"
}

Response:
{
    "projectId": "proj-uuid-123",
    "name": "2025ë…„ ì¬ë¬´ ë¶„ì„",
    "ownerId": "user-id-123",
    "createdAt": "2025-12-16T10:00:00Z"
}

---

GET /api/projects
Headers: Authorization: Bearer {accessToken}

Response:
{
    "projects": [
        {
            "projectId": "proj-uuid-123",
            "name": "2025ë…„ ì¬ë¬´ ë¶„ì„",
            "role": "OWNER",
            "memberCount": 3,
            "lastAccessedAt": "2025-12-16T11:00:00Z"
        }
    ]
}

---

GET /api/projects/{projectId}
Headers: Authorization: Bearer {accessToken}

Response:
{
    "projectId": "proj-uuid-123",
    "name": "2025ë…„ ì¬ë¬´ ë¶„ì„",
    "description": "...",
    "owner": {
        "userId": "user-id-123",
        "name": "í™ê¸¸ë™",
        "email": "user@example.com"
    },
    "members": [
        {
            "userId": "user-id-456",
            "name": "ê¹€ì² ìˆ˜",
            "role": "EDITOR",
            "joinedAt": "2025-12-16T10:30:00Z"
        }
    ],
    "createdAt": "2025-12-16T10:00:00Z"
}

---

POST /api/projects/{projectId}/members
Headers: Authorization: Bearer {accessToken}
Body:
{
    "email": "member@example.com",
    "role": "EDITOR"
}

Response:
{
    "userId": "user-id-789",
    "email": "member@example.com",
    "role": "EDITOR",
    "joinedAt": "2025-12-16T11:00:00Z"
}

---

PUT /api/projects/{projectId}/members/{userId}
Headers: Authorization: Bearer {accessToken}
Body:
{
    "role": "VIEWER"
}

Response: 200 OK

---

DELETE /api/projects/{projectId}/members/{userId}
Headers: Authorization: Bearer {accessToken}

Response: 200 OK
```

### 3.4 Spring Boot êµ¬í˜„

#### 3.4.1 ëª¨ë¸ í´ë˜ìŠ¤

```java
// User.java
@Document(collection = "users")
@Data
@Builder
@NoArgsConstructor
@AllArgsConstructor
public class User {
    @Id
    private String id;
    
    @Indexed(unique = true)
    private String email;
    
    private String password;  // BCrypt ì•”í˜¸í™”
    private String name;
    
    @Field("created_at")
    private LocalDateTime createdAt;
    
    @Field("last_login_at")
    private LocalDateTime lastLoginAt;
    
    @Field("is_active")
    private Boolean isActive = true;
}

// Project.java
@Document(collection = "projects")
@Data
@Builder
@NoArgsConstructor
@AllArgsConstructor
public class Project {
    @Id
    private String id;
    
    @Indexed(unique = true)
    @Field("project_id")
    private String projectId;
    
    private String name;
    private String description;
    
    @Field("owner_id")
    private String ownerId;
    
    @Field("created_at")
    private LocalDateTime createdAt;
    
    @Field("updated_at")
    private LocalDateTime updatedAt;
    
    @Field("is_active")
    private Boolean isActive = true;
    
    private Map<String, Object> settings;
}

// ProjectMember.java
@Document(collection = "project_members")
@Data
@Builder
@NoArgsConstructor
@AllArgsConstructor
public class ProjectMember {
    @Id
    private String id;
    
    @Field("project_id")
    private String projectId;
    
    @Field("user_id")
    private String userId;
    
    @Field("role")
    private ProjectRole role;  // OWNER, EDITOR, VIEWER
    
    @Field("invited_by")
    private String invitedBy;
    
    @Field("joined_at")
    private LocalDateTime joinedAt;
    
    private Map<String, Boolean> permissions;
}

public enum ProjectRole {
    OWNER,
    EDITOR,
    VIEWER
}
```

#### 3.4.2 ì„œë¹„ìŠ¤ êµ¬í˜„

```java
@Service
@RequiredArgsConstructor
public class AuthService {
    
    private final UserRepository userRepository;
    private final PasswordEncoder passwordEncoder;
    private final JwtTokenProvider jwtTokenProvider;
    
    /**
     * íšŒì›ê°€ì…
     */
    @Transactional
    public User register(RegisterRequest request) {
        // 1. ì´ë©”ì¼ ì¤‘ë³µ í™•ì¸
        if (userRepository.existsByEmail(request.getEmail())) {
            throw new DuplicateEmailException("ì´ë¯¸ ì‚¬ìš© ì¤‘ì¸ ì´ë©”ì¼ì…ë‹ˆë‹¤");
        }
        
        // 2. ë¹„ë°€ë²ˆí˜¸ ì•”í˜¸í™”
        String encodedPassword = passwordEncoder.encode(request.getPassword());
        
        // 3. ì‚¬ìš©ì ìƒì„±
        User user = User.builder()
                .email(request.getEmail())
                .password(encodedPassword)
                .name(request.getName())
                .createdAt(LocalDateTime.now())
                .isActive(true)
                .build();
        
        return userRepository.save(user);
    }
    
    /**
     * ë¡œê·¸ì¸
     */
    public LoginResponse login(LoginRequest request) {
        // 1. ì‚¬ìš©ì ì¡°íšŒ
        User user = userRepository.findByEmail(request.getEmail())
                .orElseThrow(() -> new InvalidCredentialsException("ì´ë©”ì¼ ë˜ëŠ” ë¹„ë°€ë²ˆí˜¸ê°€ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤"));
        
        // 2. ë¹„ë°€ë²ˆí˜¸ í™•ì¸
        if (!passwordEncoder.matches(request.getPassword(), user.getPassword())) {
            throw new InvalidCredentialsException("ì´ë©”ì¼ ë˜ëŠ” ë¹„ë°€ë²ˆí˜¸ê°€ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤");
        }
        
        // 3. JWT í† í° ìƒì„±
        String accessToken = jwtTokenProvider.createAccessToken(user.getId(), user.getEmail());
        String refreshToken = jwtTokenProvider.createRefreshToken(user.getId());
        
        // 4. ë§ˆì§€ë§‰ ë¡œê·¸ì¸ ì‹œê°„ ì—…ë°ì´íŠ¸
        user.setLastLoginAt(LocalDateTime.now());
        userRepository.save(user);
        
        return LoginResponse.builder()
                .accessToken(accessToken)
                .refreshToken(refreshToken)
                .userId(user.getId())
                .email(user.getEmail())
                .name(user.getName())
                .build();
    }
}

@Service
@RequiredArgsConstructor
public class ProjectService {
    
    private final ProjectRepository projectRepository;
    private final ProjectMemberRepository projectMemberRepository;
    private final UserRepository userRepository;
    
    /**
     * í”„ë¡œì íŠ¸ ìƒì„±
     */
    @Transactional
    public Project createProject(String userId, CreateProjectRequest request) {
        // 1. í”„ë¡œì íŠ¸ ìƒì„±
        Project project = Project.builder()
                .projectId(UUID.randomUUID().toString())
                .name(request.getName())
                .description(request.getDescription())
                .ownerId(userId)
                .createdAt(LocalDateTime.now())
                .updatedAt(LocalDateTime.now())
                .isActive(true)
                .settings(new HashMap<>())
                .build();
        
        project = projectRepository.save(project);
        
        // 2. Owner ë©¤ë²„ ì¶”ê°€
        ProjectMember owner = ProjectMember.builder()
                .projectId(project.getProjectId())
                .userId(userId)
                .role(ProjectRole.OWNER)
                .joinedAt(LocalDateTime.now())
                .permissions(getOwnerPermissions())
                .build();
        
        projectMemberRepository.save(owner);
        
        return project;
    }
    
    /**
     * ë©¤ë²„ ì´ˆëŒ€
     */
    @Transactional
    public ProjectMember inviteMember(String projectId, String invitedBy, InviteMemberRequest request) {
        // 1. ê¶Œí•œ í™•ì¸ (OWNERë§Œ ê°€ëŠ¥)
        validateOwnerPermission(projectId, invitedBy);
        
        // 2. ì‚¬ìš©ì ì¡°íšŒ
        User user = userRepository.findByEmail(request.getEmail())
                .orElseThrow(() -> new UserNotFoundException("ì‚¬ìš©ìë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤"));
        
        // 3. ì´ë¯¸ ë©¤ë²„ì¸ì§€ í™•ì¸
        if (projectMemberRepository.existsByProjectIdAndUserId(projectId, user.getId())) {
            throw new AlreadyMemberException("ì´ë¯¸ í”„ë¡œì íŠ¸ ë©¤ë²„ì…ë‹ˆë‹¤");
        }
        
        // 4. ë©¤ë²„ ì¶”ê°€
        ProjectMember member = ProjectMember.builder()
                .projectId(projectId)
                .userId(user.getId())
                .role(request.getRole())
                .invitedBy(invitedBy)
                .joinedAt(LocalDateTime.now())
                .permissions(getPermissionsByRole(request.getRole()))
                .build();
        
        return projectMemberRepository.save(member);
    }
    
    /**
     * ì‚¬ìš©ì í”„ë¡œì íŠ¸ ëª©ë¡ ì¡°íšŒ
     */
    public List<ProjectSummary> getUserProjects(String userId) {
        // 1. ì‚¬ìš©ìê°€ ì†í•œ í”„ë¡œì íŠ¸ ë©¤ë²„ì‹­ ì¡°íšŒ
        List<ProjectMember> memberships = projectMemberRepository.findByUserId(userId);
        
        // 2. í”„ë¡œì íŠ¸ ì •ë³´ ì¡°íšŒ
        List<String> projectIds = memberships.stream()
                .map(ProjectMember::getProjectId)
                .collect(Collectors.toList());
        
        List<Project> projects = projectRepository.findByProjectIdIn(projectIds);
        
        // 3. ìš”ì•½ ì •ë³´ ìƒì„±
        return projects.stream()
                .map(project -> {
                    ProjectMember membership = memberships.stream()
                            .filter(m -> m.getProjectId().equals(project.getProjectId()))
                            .findFirst()
                            .orElseThrow();
                    
                    int memberCount = projectMemberRepository.countByProjectId(project.getProjectId());
                    
                    return ProjectSummary.builder()
                            .projectId(project.getProjectId())
                            .name(project.getName())
                            .role(membership.getRole())
                            .memberCount(memberCount)
                            .lastAccessedAt(project.getUpdatedAt())
                            .build();
                })
                .collect(Collectors.toList());
    }
}
```

---

## 4. Phase 1: ëŒ€ìš©ëŸ‰ íŒŒì¼ ì—…ë¡œë“œ

### 4.1 ëª©í‘œ

```
âœ… 50-100MB ì´ìƒ Excel íŒŒì¼ ì²˜ë¦¬
âœ… S3 Presigned URL ì§ì ‘ ì—…ë¡œë“œ
âœ… SQS + Lambda ë³‘ë ¬ ì²˜ë¦¬
âœ… ì§„í–‰ë¥  ì‹¤ì‹œê°„ ì¶”ì  (Redis)
âœ… ì—ëŸ¬ ì²˜ë¦¬ ë° ì¬ì‹œë„
```

### 4.2 ì•„í‚¤í…ì²˜

```
[Browser]
    â”‚
    â”‚ 1. Presigned URL ìš”ì²­
    â–¼
[Spring Boot API]
    â”‚
    â”‚ 2. Presigned URL ìƒì„±
    â–¼
[S3 Bucket]
    â”‚
    â”‚ 3. S3 Event â†’ SQS
    â–¼
[Lambda Coordinator]
    â”‚
    â”‚ 4. íŒŒì¼ ë¶„ì„ (ì´ í–‰ ìˆ˜, ì²­í¬ ë¶„í• )
    â”‚ 5. 10ê°œ SQS ë©”ì‹œì§€ ë°œí–‰
    â–¼
[SQS Queue] â†’ [Lambda Worker Ã— 10 (ë³‘ë ¬)]
    â”‚
    â”‚ 6. ê° Workerê°€ ìê¸° ë²”ìœ„ íŒŒì‹±
    â”‚ 7. MongoDB ë°°ì¹˜ ì‚½ì…
    â”‚ 8. Redis ì§„í–‰ë¥  ì—…ë°ì´íŠ¸
    â–¼
[DocumentDB (MongoDB)]
```

### 4.3 Lambda í•¨ìˆ˜ êµ¬í˜„

#### 4.3.1 Lambda Coordinator

```java
public class ExcelCoordinator implements RequestHandler<S3Event, String> {
    
    @Override
    public String handleRequest(S3Event event, Context context) {
        // 1. S3 ì´ë²¤íŠ¸ íŒŒì‹±
        String bucket = event.getRecords().get(0).getS3().getBucket().getName();
        String key = event.getRecords().get(0).getS3().getObject().getKey();
        
        // 2. ë©”íƒ€ë°ì´í„°ë§Œ ë¶„ì„ (ë¹ ë¥´ê²Œ)
        S3Object s3Object = s3Client.getObject(bucket, key);
        Workbook workbook = new XSSFWorkbook(s3Object.getObjectContent());
        Sheet sheet = workbook.getSheetAt(0);
        
        int totalRows = sheet.getPhysicalNumberOfRows() - 1;  // í—¤ë” ì œì™¸
        
        // 3. ì²­í¬ ë¶„í•  (10ë§Œ í–‰ì”©)
        int chunkSize = 100000;
        int numChunks = (int) Math.ceil((double) totalRows / chunkSize);
        
        // 4. SQS ë©”ì‹œì§€ ë°œí–‰ (ê° ì²­í¬ë§ˆë‹¤)
        for (int i = 0; i < numChunks; i++) {
            int startRow = i * chunkSize + 1;  // í—¤ë” ë‹¤ìŒë¶€í„°
            int endRow = Math.min(startRow + chunkSize - 1, totalRows);
            
            ProcessingMessage message = ProcessingMessage.builder()
                    .s3Bucket(bucket)
                    .s3Key(key)
                    .projectId(extractProjectId(key))
                    .sessionId(extractSessionId(key))
                    .startRow(startRow)
                    .endRow(endRow)
                    .totalRows(totalRows)
                    .build();
            
            sqsClient.sendMessage(queueUrl, objectMapper.writeValueAsString(message));
        }
        
        // 5. Redis ì´ˆê¸°í™”
        redisClient.hset("upload:status:" + uploadId, "status", "PROCESSING");
        redisClient.hset("upload:status:" + uploadId, "totalRows", String.valueOf(totalRows));
        redisClient.hset("upload:status:" + uploadId, "processedRows", "0");
        
        return "Success: " + numChunks + " chunks created";
    }
}
```

#### 4.3.2 Lambda Worker

```java
public class ExcelWorker implements RequestHandler<SQSEvent, String> {
    
    @Override
    public String handleRequest(SQSEvent event, Context context) {
        for (SQSEvent.SQSMessage message : event.getRecords()) {
            ProcessingMessage msg = objectMapper.readValue(
                message.getBody(), ProcessingMessage.class
            );
            
            processChunk(msg);
        }
        
        return "Success";
    }
    
    private void processChunk(ProcessingMessage msg) {
        // 1. S3ì—ì„œ íŒŒì¼ ë‹¤ìš´ë¡œë“œ
        S3Object s3Object = s3Client.getObject(msg.getS3Bucket(), msg.getS3Key());
        
        // 2. Excel ì—´ê¸°
        Workbook workbook = new XSSFWorkbook(s3Object.getObjectContent());
        Sheet sheet = workbook.getSheetAt(0);
        
        // 3. í—¤ë” ì¶”ì¶œ
        Row headerRow = sheet.getRow(0);
        List<String> headers = extractHeaders(headerRow);
        
        // 4. ìê¸° ë²”ìœ„ë§Œ íŒŒì‹±
        List<RawDataDocument> batch = new ArrayList<>();
        for (int i = msg.getStartRow(); i <= msg.getEndRow(); i++) {
            Row row = sheet.getRow(i);
            if (row == null) continue;
            
            Map<String, Object> data = extractRowData(headers, row);
            
            RawDataDocument doc = RawDataDocument.builder()
                    .projectId(msg.getProjectId())
                    .sessionId(msg.getSessionId())
                    .data(data)
                    .importDate(LocalDateTime.now())
                    .fileName(extractFileName(msg.getS3Key()))
                    .isHidden(false)
                    .build();
            
            batch.add(doc);
            
            // 5. 2ë§Œ ê±´ì”© ë°°ì¹˜ ì‚½ì…
            if (batch.size() >= 20000) {
                mongoClient.insertMany(batch);
                batch.clear();
                
                // 6. Redis ì§„í–‰ë¥  ì—…ë°ì´íŠ¸
                updateProgress(msg.getUploadId(), 20000);
            }
        }
        
        // 7. ë‚¨ì€ ë°ì´í„° ì‚½ì…
        if (!batch.isEmpty()) {
            mongoClient.insertMany(batch);
            updateProgress(msg.getUploadId(), batch.size());
        }
    }
    
    private void updateProgress(String uploadId, int count) {
        redisClient.hincrby("upload:status:" + uploadId, "processedRows", count);
    }
}
```

### 4.4 ì„±ëŠ¥ ë²¤ì¹˜ë§ˆí¬

| íŒŒì¼ í¬ê¸° | í–‰ ìˆ˜ | ê¸°ì¡´ (C# ë‹¨ì¼ ìŠ¤ë ˆë“œ) | ì‹ ê·œ (Lambda 10ë³‘ë ¬) | ê°œì„ ìœ¨ |
|-----------|-------|---------------------|---------------------|--------|
| 50MB | 100,000í–‰ | 60ì´ˆ | 6ì´ˆ | 10ë°° |
| 100MB | 200,000í–‰ | 120ì´ˆ | 12ì´ˆ | 10ë°° |
| 500MB | 1,000,000í–‰ | 600ì´ˆ (10ë¶„) | 60ì´ˆ (1ë¶„) | 10ë°° |

---

## 5. Phase 2: ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ êµ¬í˜„

### 5.1 7ë‹¨ê³„ í”„ë¡œì„¸ìŠ¤

**ê¸°ì¡´ C# í”„ë¡œì íŠ¸ ì°¸ê³ :**
- GitHub: https://github.com/scschwan/lgcns_1st_nosql.git
- ê° ë‹¨ê³„ì˜ C# ì½”ë“œ êµ¬ì¡° ë° ë¡œì§ì„ Spring Bootë¡œ ê·¸ëŒ€ë¡œ ì¬í˜„

```
Step 1: Multi File Upload
   â†’ file_sessions ìƒì„±, ì—¬ëŸ¬ íŒŒì¼ ì—…ë¡œë“œ

Step 2: File Load
   â†’ Excel íŒŒì‹± â†’ raw_data ì €ì¥

Step 3: Preprocessing
   â†’ ì»¬ëŸ¼ ì„ íƒ, ë°ì´í„° ì •ì œ â†’ process_data

Step 4: Data Transform
   â†’ ì§‘ê³„ ê³„ì‚°, ê·¸ë£¹í•‘ â†’ process_data ë³€í™˜

Step 5: Classification
   â†’ í‚¤ì›Œë“œ ê¸°ë°˜ ë¶„ë¥˜

Step 6: Clustering
   â†’ K-Means í´ëŸ¬ìŠ¤í„°ë§ â†’ clustering_results

Step 7: Detail Clustering
   â†’ ì„¸ë¶€ í´ëŸ¬ìŠ¤í„° ë¶„ì„
```

### 5.2 ê° ë‹¨ê³„ë³„ Spring Boot ì„œë¹„ìŠ¤ êµ¬ì¡°

```java
// Step 1: Multi File Upload
@Service
public class MultiFileUploadService {
    // ê¸°ì¡´ C#: uc/Process/uc_MultiFileUploadSessionProcess.cs
}

// Step 2: File Load
@Service
public class FileLoadService {
    // ê¸°ì¡´ C#: uc/Process/uc_FileLoadProcess.cs
}

// Step 3: Preprocessing
@Service
public class PreprocessingService {
    // ê¸°ì¡´ C#: uc/Process/uc_PreprocessingProcess.cs
}

// Step 4: Data Transform
@Service
public class DataTransformService {
    // ê¸°ì¡´ C#: uc/Process/uc_DataTransformProcess.cs
}

// Step 5: Classification
@Service
public class ClassificationService {
    // ê¸°ì¡´ C#: uc/Process/uc_ClassificationProcess.cs
}

// Step 6: Clustering
@Service
public class ClusteringService {
    // ê¸°ì¡´ C#: uc/Process/uc_ClusteringProcess.cs
    // K-Means ì•Œê³ ë¦¬ì¦˜ ì¬í˜„
}

// Step 7: Detail Clustering
@Service
public class DetailClusteringService {
    // ê¸°ì¡´ C#: uc/Process/uc_DetailClusteringProcess.cs
}
```

### 5.3 UI êµ¬í˜„ (React)

**ê¸°ì¡´ C# WinForms UIë¥¼ ë°˜ì‘í˜• ì›¹ìœ¼ë¡œ ì¬í•´ì„:**

```
C# WinForms êµ¬ì¡°:
â”œâ”€â”€ uc_MultiFileUpload.cs       â†’ React: MultiFileUploadPage.jsx
â”œâ”€â”€ uc_FileLoad.cs              â†’ React: FileLoadPage.jsx
â”œâ”€â”€ uc_Preprocessing.cs         â†’ React: PreprocessingPage.jsx
â”œâ”€â”€ uc_DataTransform.cs         â†’ React: DataTransformPage.jsx
â”œâ”€â”€ uc_Classification.cs        â†’ React: ClassificationPage.jsx
â”œâ”€â”€ uc_Clustering.cs            â†’ React: ClusteringPage.jsx
â””â”€â”€ uc_DetailClustering.cs      â†’ React: DetailClusteringPage.jsx
```

**ë°˜ì‘í˜• í…œí”Œë¦¿ ì ìš©:**
- Material-UI ë˜ëŠ” Ant Design
- ëª¨ë°”ì¼/íƒœë¸”ë¦¿/ë°ìŠ¤í¬í†± ëŒ€ì‘
- C# WinFormsì˜ ë ˆì´ì•„ì›ƒì„ ì›¹ ì¹´ë“œ/íƒ­ êµ¬ì¡°ë¡œ ë³€í™˜

---

## 6. ë°ì´í„°ë² ì´ìŠ¤ ì„¤ê³„

### 6.1 ì»¬ë ‰ì…˜ ëª©ë¡

```
1. users                    # ì‚¬ìš©ì ì •ë³´
2. projects                 # í”„ë¡œì íŠ¸ ì •ë³´
3. project_members          # í”„ë¡œì íŠ¸ ë©¤ë²„ ë° ê¶Œí•œ
4. file_sessions            # ì„¸ì…˜ ê´€ë¦¬ (í”„ë¡œì íŠ¸ ì—°ë™)
5. uploaded_files           # ì—…ë¡œë“œ íŒŒì¼ ë©”íƒ€ë°ì´í„°
6. raw_data                 # ì›ì‹œ ë°ì´í„° (í”„ë¡œì íŠ¸ ê²©ë¦¬)
7. process_data             # ì²˜ë¦¬ëœ ë°ì´í„° (í”„ë¡œì íŠ¸ ê²©ë¦¬)
8. clustering_results       # í´ëŸ¬ìŠ¤í„°ë§ ê²°ê³¼
9. column_mappings          # ì»¬ëŸ¼ ë§¤í•‘ ì •ë³´
10. keywords                # í‚¤ì›Œë“œ ì‚¬ì „
```

### 6.2 ì»¬ë ‰ì…˜ ê°„ ê´€ê³„

```
[users]
   â”œâ”€> [projects] (owner_id)
   â””â”€> [project_members] (user_id)

[projects]
   â”œâ”€> [project_members] (project_id)
   â”œâ”€> [file_sessions] (project_id)
   â”œâ”€> [raw_data] (project_id)
   â”œâ”€> [process_data] (project_id)
   â””â”€> [clustering_results] (project_id)

[file_sessions]
   â””â”€> [uploaded_files]
           â””â”€> [raw_data]
                   â””â”€> [process_data]
                           â””â”€> [clustering_results]
```

---

## 7. ê°œë°œ ìŠ¤ì¼€ì¤„

### 7.1 Phase 0: ì¸ì¦ ë° í”„ë¡œì íŠ¸ ê´€ë¦¬ (1ì£¼)

| ì‘ì—… | ì˜ˆìƒ ì‹œê°„ | ë‹´ë‹¹ |
|------|----------|------|
| User ëª¨ë¸ ë° Repository | 0.5ì¼ | Backend |
| Project ëª¨ë¸ ë° Repository | 0.5ì¼ | Backend |
| ProjectMember ëª¨ë¸ ë° Repository | 0.5ì¼ | Backend |
| AuthService (íšŒì›ê°€ì…/ë¡œê·¸ì¸) | 1ì¼ | Backend |
| ProjectService (CRUD) | 1ì¼ | Backend |
| JWT í† í° ë°œê¸‰/ê²€ì¦ | 0.5ì¼ | Backend |
| API í†µí•© í…ŒìŠ¤íŠ¸ | 1ì¼ | Backend |
| **í•©ê³„** | **5ì¼** | |

### 7.2 Phase 1: ëŒ€ìš©ëŸ‰ íŒŒì¼ ì—…ë¡œë“œ (1ì£¼)

| ì‘ì—… | ì˜ˆìƒ ì‹œê°„ | ë‹´ë‹¹ |
|------|----------|------|
| S3 Presigned URL ìƒì„± API | 0.5ì¼ | Backend |
| Lambda Coordinator êµ¬í˜„ | 1ì¼ | Backend |
| Lambda Worker êµ¬í˜„ | 1.5ì¼ | Backend |
| SQS ë©”ì‹œì§€ ì²˜ë¦¬ | 0.5ì¼ | Backend |
| Redis ì§„í–‰ë¥  ì¶”ì  | 0.5ì¼ | Backend |
| 100MB íŒŒì¼ ì„±ëŠ¥ í…ŒìŠ¤íŠ¸ | 1ì¼ | Backend |
| **í•©ê³„** | **5ì¼** | |

### 7.3 Phase 2: ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ êµ¬í˜„ (3ì£¼)

| Step | ì˜ˆìƒ ì‹œê°„ | ë‹´ë‹¹ |
|------|----------|------|
| Step 1: Multi File Upload | 2ì¼ | Backend |
| Step 2: File Load | 2ì¼ | Backend |
| Step 3: Preprocessing | 2ì¼ | Backend |
| Step 4: Data Transform | 3ì¼ | Backend |
| Step 5: Classification | 2ì¼ | Backend |
| Step 6: Clustering | 3ì¼ | Backend |
| Step 7: Detail Clustering | 2ì¼ | Backend |
| **í•©ê³„** | **16ì¼ (ì•½ 3ì£¼)** | |

### 7.4 Phase 3: UI êµ¬í˜„ (2ì£¼)

| ì‘ì—… | ì˜ˆìƒ ì‹œê°„ | ë‹´ë‹¹ |
|------|----------|------|
| React í”„ë¡œì íŠ¸ êµ¬ì¡° | 1ì¼ | Frontend |
| ë¡œê·¸ì¸/íšŒì›ê°€ì… UI | 1ì¼ | Frontend |
| í”„ë¡œì íŠ¸ ëª©ë¡/ìƒì„± UI | 1ì¼ | Frontend |
| 7ë‹¨ê³„ í”„ë¡œì„¸ìŠ¤ UI | 5ì¼ | Frontend |
| ë°˜ì‘í˜• í…œí”Œë¦¿ ì ìš© | 2ì¼ | Frontend |
| **í•©ê³„** | **10ì¼ (2ì£¼)** | |

### 7.5 ì „ì²´ ì¼ì •

```
Week 1-2:  Phase 0 (ì¸ì¦ & í”„ë¡œì íŠ¸ ê´€ë¦¬)
Week 3-4:  Phase 1 (ëŒ€ìš©ëŸ‰ íŒŒì¼ ì—…ë¡œë“œ)
Week 5-7:  Phase 2 (ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ êµ¬í˜„)
Week 8-9:  Phase 3 (UI êµ¬í˜„)
Week 10:   í†µí•© í…ŒìŠ¤íŠ¸ & ë°°í¬

ì´ 10ì£¼ (ì•½ 2.5ê°œì›”)
```

---

## 8. ë‹¨ìœ„ ê°œë°œ ì²´í¬ë¦¬ìŠ¤íŠ¸

### 8.1 Phase 0: ì¸ì¦ ë° í”„ë¡œì íŠ¸ ê´€ë¦¬

#### 8.1.1 ì‚¬ìš©ì ì¸ì¦

```
â¬œ User ëª¨ë¸ í´ë˜ìŠ¤ ì‘ì„±
â¬œ UserRepository ì¸í„°í˜ì´ìŠ¤ ì‘ì„±
â¬œ PasswordEncoder ì„¤ì • (BCryptPasswordEncoder)
â¬œ AuthService.register() êµ¬í˜„
   â¬œ ì´ë©”ì¼ ì¤‘ë³µ ì²´í¬
   â¬œ ë¹„ë°€ë²ˆí˜¸ ì•”í˜¸í™”
   â¬œ ì‚¬ìš©ì ìƒì„±
â¬œ AuthService.login() êµ¬í˜„
   â¬œ ì‚¬ìš©ì ì¡°íšŒ
   â¬œ ë¹„ë°€ë²ˆí˜¸ ê²€ì¦
   â¬œ JWT í† í° ìƒì„±
â¬œ JwtTokenProvider êµ¬í˜„
   â¬œ Access Token ìƒì„± (1ì‹œê°„ ìœ íš¨)
   â¬œ Refresh Token ìƒì„± (7ì¼ ìœ íš¨)
   â¬œ í† í° ê²€ì¦
â¬œ AuthController ì‘ì„±
   â¬œ POST /api/auth/register
   â¬œ POST /api/auth/login
   â¬œ POST /api/auth/refresh
   â¬œ POST /api/auth/logout
â¬œ JWT ì¸ì¦ í•„í„° êµ¬í˜„ (OncePerRequestFilter)
â¬œ SecurityConfig ì„¤ì •
â¬œ Postman í…ŒìŠ¤íŠ¸
   â¬œ íšŒì›ê°€ì… â†’ ë¡œê·¸ì¸ â†’ í† í° ë°œê¸‰ í™•ì¸
```

#### 8.1.2 í”„ë¡œì íŠ¸ ê´€ë¦¬

```
â¬œ Project ëª¨ë¸ í´ë˜ìŠ¤ ì‘ì„±
â¬œ ProjectMember ëª¨ë¸ í´ë˜ìŠ¤ ì‘ì„±
â¬œ ProjectRepository ì¸í„°í˜ì´ìŠ¤ ì‘ì„±
â¬œ ProjectMemberRepository ì¸í„°í˜ì´ìŠ¤ ì‘ì„±
â¬œ ProjectService.createProject() êµ¬í˜„
   â¬œ í”„ë¡œì íŠ¸ ìƒì„±
   â¬œ Owner ë©¤ë²„ ìë™ ì¶”ê°€
â¬œ ProjectService.getUserProjects() êµ¬í˜„
   â¬œ ì‚¬ìš©ìê°€ ì†í•œ í”„ë¡œì íŠ¸ ëª©ë¡ ì¡°íšŒ
â¬œ ProjectService.inviteMember() êµ¬í˜„
   â¬œ ê¶Œí•œ í™•ì¸ (OWNERë§Œ ì´ˆëŒ€ ê°€ëŠ¥)
   â¬œ ì´ë©”ì¼ë¡œ ì‚¬ìš©ì ì¡°íšŒ
   â¬œ ë©¤ë²„ ì¶”ê°€
â¬œ ProjectService.updateMemberRole() êµ¬í˜„
â¬œ ProjectService.removeMember() êµ¬í˜„
â¬œ ProjectController ì‘ì„±
   â¬œ POST /api/projects
   â¬œ GET /api/projects
   â¬œ GET /api/projects/{projectId}
   â¬œ POST /api/projects/{projectId}/members
   â¬œ PUT /api/projects/{projectId}/members/{userId}
   â¬œ DELETE /api/projects/{projectId}/members/{userId}
â¬œ Postman í…ŒìŠ¤íŠ¸
   â¬œ í”„ë¡œì íŠ¸ ìƒì„± â†’ ë©¤ë²„ ì´ˆëŒ€ â†’ ê¶Œí•œ ë³€ê²½
```

#### 8.1.3 ë°ì´í„° ê²©ë¦¬

```
â¬œ RawDataDocumentì— projectId í•„ë“œ ì¶”ê°€
â¬œ ProcessDataDocumentì— projectId í•„ë“œ ì¶”ê°€
â¬œ ClusteringResultDocumentì— projectId í•„ë“œ ì¶”ê°€
â¬œ FileSessionDocumentì— projectId, createdBy í•„ë“œ ì¶”ê°€
â¬œ MongoDB Index ìƒì„±
   â¬œ raw_data: { project_id: 1, session_id: 1 }
   â¬œ process_data: { project_id: 1 }
   â¬œ clustering_results: { project_id: 1 }
â¬œ ëª¨ë“  Repository ë©”ì„œë“œì— projectId í•„í„° ì¶”ê°€
â¬œ í†µí•© í…ŒìŠ¤íŠ¸
   â¬œ í”„ë¡œì íŠ¸ Aì˜ ë°ì´í„°ê°€ í”„ë¡œì íŠ¸ Bì— ë…¸ì¶œë˜ì§€ ì•ŠëŠ”ì§€ í™•ì¸
```

---

### 8.2 Phase 1: ëŒ€ìš©ëŸ‰ íŒŒì¼ ì—…ë¡œë“œ

#### 8.2.1 S3 ì—…ë¡œë“œ

```
â¬œ S3Service.generatePresignedUrl() ìˆ˜ì •
   â¬œ projectIdë¥¼ S3 Keyì— í¬í•¨
   â¬œ ì˜ˆ: s3://bucket/projects/{projectId}/sessions/{sessionId}/files/{fileName}
â¬œ UploadController ìˆ˜ì •
   â¬œ projectId íŒŒë¼ë¯¸í„° ì¶”ê°€
   â¬œ í”„ë¡œì íŠ¸ ë©¤ë²„ ê¶Œí•œ í™•ì¸ (can_upload)
â¬œ Postman í…ŒìŠ¤íŠ¸
   â¬œ Presigned URL ìƒì„±
   â¬œ S3 ì§ì ‘ ì—…ë¡œë“œ
   â¬œ aws s3 lsë¡œ íŒŒì¼ í™•ì¸
```

#### 8.2.2 Lambda Coordinator

```
â¬œ ExcelCoordinator í´ë˜ìŠ¤ ì‘ì„±
â¬œ handleRequest() êµ¬í˜„
   â¬œ S3 Event íŒŒì‹±
   â¬œ Excel ë©”íƒ€ë°ì´í„° ë¶„ì„ (ì´ í–‰ ìˆ˜)
   â¬œ ì²­í¬ ë¶„í•  ê³„íš (10ë§Œ í–‰ì”©)
   â¬œ SQS ë©”ì‹œì§€ ë°œí–‰ (ê° ì²­í¬ë§ˆë‹¤)
   â¬œ Redis ì´ˆê¸°í™”
â¬œ ProcessingMessage DTO ì‘ì„±
â¬œ build.gradleì— AWS SDK ì˜ì¡´ì„± ì¶”ê°€
â¬œ Lambda ë°°í¬
   â¬œ JAR ë¹Œë“œ
   â¬œ aws lambda create-function
   â¬œ S3 Event íŠ¸ë¦¬ê±° ì„¤ì •
â¬œ í…ŒìŠ¤íŠ¸
   â¬œ 10ë§Œ í–‰ Excel â†’ 1ê°œ ë©”ì‹œì§€ í™•ì¸
   â¬œ 100ë§Œ í–‰ Excel â†’ 10ê°œ ë©”ì‹œì§€ í™•ì¸
```

#### 8.2.3 Lambda Worker

```
â¬œ ExcelWorker í´ë˜ìŠ¤ ì‘ì„±
â¬œ handleRequest() êµ¬í˜„
   â¬œ SQS ë©”ì‹œì§€ ìˆ˜ì‹ 
   â¬œ S3ì—ì„œ íŒŒì¼ ë‹¤ìš´ë¡œë“œ
   â¬œ ìê¸° ë²”ìœ„ë§Œ íŒŒì‹± (startRow~endRow)
   â¬œ MongoDB ë°°ì¹˜ ì‚½ì… (2ë§Œ ê±´ì”©)
   â¬œ Redis ì§„í–‰ë¥  ì—…ë°ì´íŠ¸
â¬œ VPC ì„¤ì • (DocumentDB/Redis ì ‘ê·¼)
â¬œ Lambda ë°°í¬
   â¬œ aws lambda create-function
   â¬œ SQS íŠ¸ë¦¬ê±° ì„¤ì • (ë°°ì¹˜ í¬ê¸°: 1)
   â¬œ ë™ì‹œ ì‹¤í–‰ ìˆ˜: 10
â¬œ í…ŒìŠ¤íŠ¸
   â¬œ 100ë§Œ í–‰ Excel íŒŒì‹±
   â¬œ 10ê°œ Worker ë³‘ë ¬ ì‹¤í–‰ í™•ì¸
   â¬œ MongoDBì— ë°ì´í„° ì‚½ì… í™•ì¸
   â¬œ Redis ì§„í–‰ë¥  í™•ì¸
```

#### 8.2.4 ì§„í–‰ë¥  ì¶”ì 

```
â¬œ UploadStatusResponse DTO ì‘ì„±
â¬œ UploadService.getUploadStatus() êµ¬í˜„
   â¬œ Redisì—ì„œ ì§„í–‰ë¥  ì¡°íšŒ
   â¬œ ì§„í–‰ë¥  ê³„ì‚°: (processedRows / totalRows) * 100
â¬œ UploadController ìˆ˜ì •
   â¬œ GET /api/upload/status/{uploadId}
â¬œ Reactì—ì„œ í´ë§ í…ŒìŠ¤íŠ¸
   â¬œ 1ì´ˆë§ˆë‹¤ ìƒíƒœ ì¡°íšŒ
   â¬œ ì§„í–‰ë¥  í‘œì‹œ (Progress Bar)
```

#### 8.2.5 ì„±ëŠ¥ í…ŒìŠ¤íŠ¸

```
â¬œ 50MB Excel íŒŒì¼ ì¤€ë¹„ (10ë§Œ í–‰)
â¬œ 100MB Excel íŒŒì¼ ì¤€ë¹„ (20ë§Œ í–‰)
â¬œ 500MB Excel íŒŒì¼ ì¤€ë¹„ (100ë§Œ í–‰)
â¬œ ê° íŒŒì¼ë³„ ì²˜ë¦¬ ì‹œê°„ ì¸¡ì •
â¬œ ë²¤ì¹˜ë§ˆí¬ ê²°ê³¼ ë¬¸ì„œí™”
```

---

### 8.3 Phase 2: ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ êµ¬í˜„

#### 8.3.1 Step 1: Multi File Upload

```
â¬œ C# ì½”ë“œ ë¶„ì„
   â¬œ uc/Process/uc_MultiFileUploadSessionProcess.cs ì½ê¸°
   â¬œ í•µì‹¬ ë¡œì§ ì¶”ì¶œ
â¬œ MultiFileUploadService ì‘ì„±
   â¬œ createSession()
   â¬œ uploadFile()
   â¬œ getSessionFiles()
â¬œ Controller API ì‘ì„±
â¬œ Postman í…ŒìŠ¤íŠ¸
```

#### 8.3.2 Step 2: File Load

```
â¬œ C# ì½”ë“œ ë¶„ì„
   â¬œ uc/Process/uc_FileLoadProcess.cs ì½ê¸°
â¬œ FileLoadService ì‘ì„±
   â¬œ loadExcelFile() (Phase 1 ì¬í™œìš©)
â¬œ Controller API ì‘ì„±
â¬œ Postman í…ŒìŠ¤íŠ¸
```

#### 8.3.3 Step 3: Preprocessing

```
â¬œ C# ì½”ë“œ ë¶„ì„
   â¬œ uc/Process/uc_PreprocessingProcess.cs ì½ê¸°
â¬œ PreprocessingService ì‘ì„±
   â¬œ preprocessData()
   â¬œ raw_data â†’ process_data ë³€í™˜
   â¬œ ì»¬ëŸ¼ ì„ íƒ
   â¬œ ë°ì´í„° ì •ì œ
â¬œ Controller API ì‘ì„±
â¬œ Postman í…ŒìŠ¤íŠ¸
   â¬œ raw_data ì¡´ì¬ í™•ì¸
   â¬œ ì»¬ëŸ¼ ì„ íƒ
   â¬œ process_data ìƒì„± í™•ì¸
```

#### 8.3.4 Step 4: Data Transform

```
â¬œ C# ì½”ë“œ ë¶„ì„
   â¬œ uc/Process/uc_DataTransformProcess.cs ì½ê¸°
â¬œ DataTransformService ì‘ì„±
   â¬œ transformData()
   â¬œ MongoDB Aggregation Pipeline
   â¬œ ì§‘ê³„ ê³„ì‚° (SUM, AVG, COUNT)
   â¬œ ê·¸ë£¹í•‘
â¬œ Controller API ì‘ì„±
â¬œ Postman í…ŒìŠ¤íŠ¸
```

#### 8.3.5 Step 5: Classification

```
â¬œ C# ì½”ë“œ ë¶„ì„
   â¬œ uc/Process/uc_ClassificationProcess.cs ì½ê¸°
â¬œ KeywordExtractor ìœ í‹¸ë¦¬í‹° ì‘ì„± (C# ì½”ë“œ ì°¸ê³ )
â¬œ ClassificationService ì‘ì„±
   â¬œ classifyData()
   â¬œ í‚¤ì›Œë“œ ê¸°ë°˜ ë¶„ë¥˜
â¬œ Controller API ì‘ì„±
â¬œ Postman í…ŒìŠ¤íŠ¸
```

#### 8.3.6 Step 6: Clustering

```
â¬œ C# ì½”ë“œ ë¶„ì„
   â¬œ uc/Process/uc_ClusteringProcess.cs ì½ê¸°
   â¬œ Utilities/ClusterManager/*.cs ì½ê¸°
â¬œ KMeans ì•Œê³ ë¦¬ì¦˜ í´ë˜ìŠ¤ ì‘ì„±
   â¬œ fit() ë©”ì„œë“œ
   â¬œ predict() ë©”ì„œë“œ
â¬œ ClusteringService ì‘ì„±
   â¬œ performKMeans()
   â¬œ clustering_results ì €ì¥
   â¬œ process_dataì— cluster_id ì—…ë°ì´íŠ¸
â¬œ Controller API ì‘ì„±
â¬œ Postman í…ŒìŠ¤íŠ¸
   â¬œ k=5ë¡œ í´ëŸ¬ìŠ¤í„°ë§ ì‹¤í–‰
   â¬œ ê²°ê³¼ í™•ì¸
```

#### 8.3.7 Step 7: Detail Clustering

```
â¬œ C# ì½”ë“œ ë¶„ì„
   â¬œ uc/Process/uc_DetailClusteringProcess.cs ì½ê¸°
â¬œ DetailClusteringService ì‘ì„±
   â¬œ analyzeCluster()
   â¬œ íŠ¹ì • í´ëŸ¬ìŠ¤í„° ì„¸ë¶€ ë¶„ì„
â¬œ Controller API ì‘ì„±
â¬œ Postman í…ŒìŠ¤íŠ¸
```

---

### 8.4 Phase 3: UI êµ¬í˜„

#### 8.4.1 React í”„ë¡œì íŠ¸ êµ¬ì¡°

```
â¬œ npx create-react-app frontend
â¬œ í´ë” êµ¬ì¡° ì„¤ì •
   â¬œ src/components/
   â¬œ src/pages/
   â¬œ src/services/
   â¬œ src/hooks/
   â¬œ src/utils/
â¬œ Material-UI ë˜ëŠ” Ant Design ì„¤ì¹˜
â¬œ React Router ì„¤ì •
â¬œ Axios ì„¤ì • (API í˜¸ì¶œ)
```

#### 8.4.2 ë¡œê·¸ì¸/íšŒì›ê°€ì… UI

```
â¬œ LoginPage.jsx ì‘ì„±
â¬œ RegisterPage.jsx ì‘ì„±
â¬œ AuthContext ì‘ì„± (JWT í† í° ê´€ë¦¬)
â¬œ PrivateRoute ì»´í¬ë„ŒíŠ¸ ì‘ì„±
â¬œ í…ŒìŠ¤íŠ¸
   â¬œ íšŒì›ê°€ì… â†’ ë¡œê·¸ì¸ â†’ í† í° ì €ì¥ í™•ì¸
```

#### 8.4.3 í”„ë¡œì íŠ¸ ê´€ë¦¬ UI

```
â¬œ ProjectListPage.jsx ì‘ì„±
   â¬œ í”„ë¡œì íŠ¸ ëª©ë¡ ì¡°íšŒ
   â¬œ í”„ë¡œì íŠ¸ ìƒì„± ë²„íŠ¼
â¬œ CreateProjectDialog.jsx ì‘ì„±
â¬œ ProjectDetailPage.jsx ì‘ì„±
   â¬œ í”„ë¡œì íŠ¸ ì •ë³´ í‘œì‹œ
   â¬œ ë©¤ë²„ ëª©ë¡
   â¬œ ë©¤ë²„ ì´ˆëŒ€ ë²„íŠ¼
â¬œ InviteMemberDialog.jsx ì‘ì„±
â¬œ í…ŒìŠ¤íŠ¸
```

#### 8.4.4 7ë‹¨ê³„ í”„ë¡œì„¸ìŠ¤ UI

```
â¬œ MultiFileUploadPage.jsx (C# uc_MultiFileUpload.cs ì°¸ê³ )
â¬œ FileLoadPage.jsx (C# uc_FileLoad.cs ì°¸ê³ )
â¬œ PreprocessingPage.jsx (C# uc_Preprocessing.cs ì°¸ê³ )
â¬œ DataTransformPage.jsx (C# uc_DataTransform.cs ì°¸ê³ )
â¬œ ClassificationPage.jsx (C# uc_Classification.cs ì°¸ê³ )
â¬œ ClusteringPage.jsx (C# uc_Clustering.cs ì°¸ê³ )
â¬œ DetailClusteringPage.jsx (C# uc_DetailClustering.cs ì°¸ê³ )
â¬œ C# WinForms UI ë ˆì´ì•„ì›ƒì„ ë°˜ì‘í˜• ì¹´ë“œ êµ¬ì¡°ë¡œ ì¬í•´ì„
â¬œ ëª¨ë°”ì¼/íƒœë¸”ë¦¿ ëŒ€ì‘
```

---

## 9. í”„ë¡œì íŠ¸ ì§„í–‰ ê°€ì´ë“œë¼ì¸

### 9.1 ê°œë°œ ì„¸ì…˜ ì‹œì‘ ì „ ì²´í¬ë¦¬ìŠ¤íŠ¸

```
âœ… ì´ ë¬¸ì„œ (project-development-guide.md) ì½ê¸°
âœ… í˜„ì¬ Phase ë° ì‘ì—… í•­ëª© í™•ì¸
âœ… ê¸°ì¡´ C# í”„ë¡œì íŠ¸ í•´ë‹¹ íŒŒì¼ ë¶„ì„
âœ… Git pull (ìµœì‹  ì½”ë“œ ë°›ê¸°)
âœ… ë¡œì»¬ í™˜ê²½ í…ŒìŠ¤íŠ¸ (Docker Compose)
```

### 9.2 ê°œë°œ ì¤‘ í•„ìˆ˜ ì›ì¹™

```
1. ê¸°ì¡´ C# ì½”ë“œë¥¼ ë¨¼ì € ì½ê³  ì´í•´í•œ í›„ Spring Bootë¡œ ë³€í™˜
2. MongoDB ì»¬ë ‰ì…˜ êµ¬ì¡° ë° í•„ë“œëª… ì ˆëŒ€ ë³€ê²½ ê¸ˆì§€
3. ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ìˆœì„œ ë³€ê²½ ê¸ˆì§€
4. ëª¨ë“  ë³€ê²½ì‚¬í•­ì€ Git commit (ëª…í™•í•œ ë©”ì‹œì§€)
5. ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ í›„ ë‹¤ìŒ ì‘ì—… ì§„í–‰
```

### 9.3 ê°œë°œ ì™„ë£Œ í›„ ì²´í¬ë¦¬ìŠ¤íŠ¸

```
âœ… ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ í†µê³¼
âœ… Postman í…ŒìŠ¤íŠ¸ ì™„ë£Œ
âœ… ì²´í¬ë¦¬ìŠ¤íŠ¸ í•­ëª© ì—…ë°ì´íŠ¸ ([x] ë§ˆí‚¹)
âœ… Git commit & push
âœ… ê°œë°œ ì¼ì§€ ì‘ì„± (ê°„ë‹¨íˆ)
```

### 9.4 ë¬¸ì œ ë°œìƒ ì‹œ ëŒ€ì‘

```
1. ì—ëŸ¬ ë©”ì‹œì§€ ì „ì²´ ë³µì‚¬
2. ê´€ë ¨ ì½”ë“œ í™•ì¸
3. ê¸°ì¡´ C# ì½”ë“œì™€ ë¹„êµ
4. ë¬¸ì œ í•´ê²° í›„ ë¬¸ì„œí™”
```

---

## 10. ì°¸ê³  ìë£Œ

### 10.1 GitHub ì €ì¥ì†Œ

- **ê¸°ì¡´ C# í”„ë¡œì íŠ¸:** https://github.com/scschwan/lgcns_1st_nosql.git
- **ì‹ ê·œ Spring Boot í”„ë¡œì íŠ¸:** https://github.com/scschwan/lg_cns_web.git

### 10.2 í”„ë¡œì íŠ¸ ë¬¸ì„œ

- **í”„ë¡œì íŠ¸ êµ¬ì„± ë¶„ì„:** project-code-analysis-report.md
- **ë ˆê±°ì‹œ ë¶„ì„ ë° ë§ˆì´ê·¸ë ˆì´ì…˜ ê³„íš:** legacy-project-analysis-and-migration-plan.md
- **2025-12-16 ê°œë°œ ì •ë¦¬:** 2025-12-16-development-summary.md

### 10.3 AWS ì¸í”„ë¼ ë¬¸ì„œ

- **AWS ì•„í‚¤í…ì²˜:** 01-aws-architecture-and-cost.md
- **ì„œë¹„ìŠ¤ ì•„í‚¤í…ì²˜:** 02-service-architecture.md
- **í”„ë¡œì„¸ìŠ¤ í”Œë¡œìš°:** 03-process-flow.md
- **ì¸í”„ë¼ êµ¬ì¶•:** 04-aws-infrastructure-setup.md
- **ê°œë°œ í™˜ê²½ êµ¬ì¶•:** 05-development-environment-setup.md

---

**ë¬¸ì„œ ë²„ì „:** 1.0  
**ìµœì¢… ì—…ë°ì´íŠ¸:** 2025-12-16 21:30 KST  
**ì‘ì„±ì:** dhkim  
**í”„ë¡œì íŠ¸ ê¸°ê°„:** 2025-12 ~ 2026-02 (ì•½ 10ì£¼)

> **âš ï¸ ì¤‘ìš”:**
> 
> ì´ ë¬¸ì„œëŠ” í”„ë¡œì íŠ¸ì˜ **ë§ˆìŠ¤í„° ê°€ì´ë“œ**ì…ë‹ˆë‹¤.
> - ëª¨ë“  ê°œë°œì€ ì´ ë¬¸ì„œì˜ Phase ìˆœì„œë¥¼ ë”°ë¼ì•¼ í•©ë‹ˆë‹¤
> - ì„ì˜ë¡œ ìˆœì„œë¥¼ ë³€ê²½í•˜ê±°ë‚˜ ë‹¨ê³„ë¥¼ ê±´ë„ˆë›°ì§€ ë§ˆì„¸ìš”
> - ê¸°ì¡´ C# í”„ë¡œì íŠ¸ì˜ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì„ 100% ì¬í˜„í•˜ëŠ” ê²ƒì´ í•µì‹¬ì…ë‹ˆë‹¤
> - ì˜ë¬¸ì‚¬í•­ ë°œìƒ ì‹œ ì´ ë¬¸ì„œë¥¼ ë¨¼ì € ì°¸ê³ í•˜ì„¸ìš”
